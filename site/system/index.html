<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>System Overview - Machine Learning for Tagging Graphic Designs</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "System Overview";
    var mkdocs_page_input_path = "system.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Machine Learning for Tagging Graphic Designs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../setup/">Setup Instructions</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../tands/">Tools and Services</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">System Overview</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#structure-of-s3-bucket-containing-datasets">Structure of S3 Bucket Containing Datasets</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#structure-of-jupyter-notebook">Structure of Jupyter Notebook</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-overview">Data Overview</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#images">Images</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#list-files">List Files</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-processing">Data Processing</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#downloading-images-from-s3">Downloading Images From S3</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#create-dataset-using-recordio">Create Dataset Using RecordIO</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#model-training">Model Training</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#model-deployment">Model Deployment</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../code-walthroughs/">Code Walkthroughs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../resources/">Additional Resources</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Machine Learning for Tagging Graphic Designs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>System Overview</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="system-overview">System Overview</h1>
<p>Overview of the components and structures of our project. </p>
<hr />
<h2 id="structure-of-s3-bucket-containing-datasets">Structure of S3 Bucket Containing Datasets</h2>
<p>Datasets are stored in an S3 bucket named: <code>sagemaker-multi-label-data</code></p>
<p>The following shows the file structure of this bucket:</p>
<pre><code>sagemaker-multi-label-data/
    50-label-rs96/
        training/
            train.rec
        validation/
            val.rec
        output/
            training outputs
    ic-multi-label
        training/
            train.rec
        validation/
            val.rec
        output/
            training outputs
</code></pre>
<p>There are two datasets with different properties in this bucket. This table shows the properties of each of the datasets:</p>
<style type="text/css">
.tg  {border-collapse:collapse;border-color:#93a1a1;border-spacing:0;}
.tg td{background-color:#fdf6e3;border-color:#93a1a1;border-style:solid;border-width:1px;color:#002b36;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{background-color:#657b83;border-color:#93a1a1;border-style:solid;border-width:1px;color:#fdf6e3;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-1wig{font-weight:bold;text-align:left;vertical-align:top}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-1wig">Bucket </th>
    <th class="tg-1wig">Prefix</th>
    <th class="tg-1wig"># of Labels</th>
    <th class="tg-1wig"># Training Samples</th>
    <th class="tg-1wig">Image Size Pixels</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">sagemaker-multi-label-data</td>
    <td class="tg-0lax">50-label-rs96</td>
    <td class="tg-0lax">50</td>
    <td class="tg-0lax">98378</td>
    <td class="tg-0lax">96x96</td>
  </tr>
  <tr>
    <td class="tg-0lax">sagemaker-multi-label-data</td>
    <td class="tg-0lax">ic-multi-label</td>
    <td class="tg-0lax">334</td>
    <td class="tg-0lax">116945</td>
    <td class="tg-0lax">96x96</td>
  </tr>
</tbody>
</table>
<p>&nbsp;</p>

<p>Training models with either of these datasets can be done through the files in our Jupyter Notebook.</p>
<hr />
<h2 id="structure-of-jupyter-notebook">Structure of Jupyter Notebook</h2>
<p>The following shows the file structure of the Jupyter notebook:</p>
<pre><code>machine-learning-for-taggging-graphic-designs/
    334-label/
        resize-96/
            train.ipynb
            tune.ipynb
    50-label/
        resize-96/
            train.ipynb
            tune.ipynb
</code></pre>
<p>This table shows what dataset is used by what Jupyter Notebook file:</p>
<style type="text/css">
.tg  {border-collapse:collapse;border-color:#93a1a1;border-spacing:0;}
.tg td{background-color:#fdf6e3;border-color:#93a1a1;border-style:solid;border-width:1px;color:#002b36;
  font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{background-color:#657b83;border-color:#93a1a1;border-style:solid;border-width:1px;color:#fdf6e3;
  font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax">Location of File in Jupyter Notebook</th>
    <th class="tg-0lax">S3 Location of Dataset Used by that file</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">334-label/resize-96/train.ipynb<br>334-label/resize-96/tune.ipynb</td>
    <td class="tg-0lax">sagemaker-multi-label-data/ic-multi-label/</td>
  </tr>
  <tr>
    <td class="tg-0lax">50-label/resize-96/train.ipynb<br>50-label/resize-96/tune.ipynb</td>
    <td class="tg-0lax">sagemaker-multi-label-data/50-label-rs96/</td>
  </tr>
</tbody>
</table>
<p>&nbsp;</p>

<p>As you can see different files in the Jupyter Notebook use different datasets. This means that we are able to train a model with either 50-label images, or 334-label images.</p>
<hr />
<h2 id="data-overview">Data Overview</h2>
<h3 id="images">Images</h3>
<p>The raw data consists of ~155,000 classified images stored in S3. Each image can belong to one, or more of 334 classes. </p>
<h3 id="list-files">List Files</h3>
<p>List files includes the label data for each image as well as the path to the image. We use the list file to associate the images and their classes.
Each line in the list file takes the following format:</p>
<pre><code>Image-ID   label_1   label_2  ...  label_334    Image-Path
</code></pre>
<p>The labels represent the classes that images can belong to. Label values can either be 0, meaning the image does not belong to that class, or 1 meaning the image does belong to that class.</p>
<p>For example, lets say we have 3 images that can belong to 3 classes: flower, leaf, and blue. The list file would look like this:</p>
<pre><code>0     1       0       0   image1.jpg
1     0       1       1   image2.jpg
2     1       1       1   image3.jpg
</code></pre>
<p>The first column is a unique ID for each image. The next 3 columns are the images label data and the last column is the path of the image. Lets add the column headers in for the sake of understanding our example:</p>
<pre><code>ID    flower  leaf    blue  path
0     1       0       0     image1.jpg
1     0       1       1     image2.jpg
2     1       1       1     image3.jpg
</code></pre>
<p><strong>Note:</strong> The column headers would not be included in the List file.</p>
<p>We can see that the first label is flower, the second is leaf and the third is blue. So, image1.jpg belongs to the class flower only, image2.jpg is belongs to both the leaf and blue class and image3.jpg belongs to all three classes.</p>
<p>List files are a crucial part of processing the data. They contain the label data associated with each image. Each image and its label data will be packed into the final format of the training dataset. </p>
<hr />
<h2 id="data-processing">Data Processing</h2>
<p>Using the raw images for training is possible, but inefficient. Processing the images allows for faster training and less resource consumption.</p>
<p>Processing the images involves the following steps:</p>
<ol>
<li>Download images from S3.</li>
<li>Create dataset using RecordIO.</li>
</ol>
<h4 id="downloading-images-from-s3">Downloading Images From S3</h4>
<p>We were provided a list file containing the label data and S3 location of every image: </p>
<pre><code>    ID      labels 1-334      Path to image in S3
</code></pre>
<p>To download the images we used a python script to parse each line of the original list file, then write the S3 location of each image into a file called <code>s3-paths.txt</code>. Then, using a tool called boto3, we connect to S3 and download every image to a local machine.</p>
<p>For more information on Boto3 see the <a href="../tands/#boto3">Tools and Services: Boto3</a>.</p>
<p>Check out <a href="../code-walthroughs/#downloading-the-images">Code Walkthrough: Downloading the Images</a> to see how we downloaded the images.</p>
<h4 id="create-dataset-using-recordio">Create Dataset Using RecordIO</h4>
<p>We use MXNet's RecordIO data format for the dataset. This provides many benefits such as: reducing training time, reducing overall size of the dataset and more.</p>
<p>We have to convert the raw images and the label data into the RecordIO data format. To do this we use a tool called im2rec.py provided by MXNet. This tool takes our list file and the root directory containing our images and produces a .rec dataset. </p>
<p>The .rec file that im2rec.py generates can be used as training data. We upload the dataset back to S3 and we are ready to use it for training.</p>
<p>Check out <a href="../code-walthroughs/#code-walkthrough-creating-datasets">Code Walkthrough: Creating Datasets</a> to see how we created the datasets in the RecordIO format.</p>
<hr />
<h2 id="model-training">Model Training</h2>
<p>Training a machine Learning model with SageMaker is done through the SageMaker Notebook instance. Within the instance we write code to setup and run training jobs.</p>
<p>Training jobs in SageMaker include the following information:</p>
<ul>
<li>Location of training data.<ul>
<li>The training data is stored in an Amazon Simple Storage bucket.</li>
<li>The URL of the bucket containing the training data is provided to the training job before launching it.</li>
</ul>
</li>
<li>Type of compute instance to use for training.<ul>
<li>Training models is done in a separate compute instance.</li>
<li>There are several types of compute instances that can be used for training. </li>
<li>The desired type of compute instance is provided to the training job before launching it.</li>
</ul>
</li>
<li>Location of where the output should be stored.<ul>
<li>The URL of the bucket where outputs from a training job should be stored.</li>
</ul>
</li>
<li>Path of EC2 container registry where training code is stored.<ul>
<li>This path contains an image of the actual training algorithm.</li>
<li>SageMaker provides several built-in training images that can be used.</li>
<li>The path of the container where the training image is stored is provided to the training job before launching it.</li>
</ul>
</li>
</ul>
<p>We write code in our notebook instance to specify all of this information before launching the training job. Additionally, we specify some model parameters that describe how the training should take place.</p>
<p>Check out <a href="../code-walthroughs/#code-walkthrough-training">Code Walkthrough: Training</a> and <a href="../code-walthroughs/#code-walkthrough-hyperparameter-tuning">Code Walkthrough: Hyperparameter Tuning</a> to see how we trained models from our Jupyter notebook.</p>
<hr />
<h2 id="model-deployment">Model Deployment</h2>
<p>Trained models can be deployed to endpoints with sagemaker. The endpoint can then receive input data from a client application and pass it to the trained model. The models output is then returned back to the client application through the endpoint. </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../code-walthroughs/" class="btn btn-neutral float-right" title="Code Walkthroughs">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../tands/" class="btn btn-neutral" title="Tools and Services"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../tands/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../code-walthroughs/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
